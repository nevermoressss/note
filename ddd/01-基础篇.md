##### 微服务设计和拆分的困境 
    进入微服务架构时代后，微服务解决了原来采用集中式架构的单体应用的很多问题，比如扩展性、弹性伸缩能力、小规模团队的敏捷开发等
    但是微服务实践过程中产生了不少的争论和疑惑：微服务的力度应该多大呀？微服务到底如何拆分和设计呢？微服务的边界应该在哪里？
    微服务拆分困境产生的根本原因就是不知道业务或者微服务的边界到底在什么地方。确定了业务边界和应用的边界，这个困境也就迎刃而解了。
##### 为什么 DDD 适合微服务？ 
    DDD 核心思想是通过领域驱动设计方法定义领域模型，从而确定业务和应用边界，保证业务模型与代码模型的一致性。  
    利用 DDD 设计方法来建立领域模型，划分领域边界，再根据这些领域边界从业务视角来划分微服务边界。而按照 DDD 方法设计出的微服务的业务和应用边界都非常合理，可以很好地实现微服务内部和外部的“高内聚、低耦合”。  
    DDD 不是架构，而是一种架构设计方法论，它通过边界划分将复杂业务领域简单化，帮我们设计出清晰的领域和应用边界，可以很容易地实现架构演进。
##### DDD包含战略设计和战术设计两部分
    战略设计主要从业务视角出发，建立业务领域模型，划分领域边界，建立通用语言的限界上下文，限界上下文可以作为微服务设计的参考边界。
    战术设计则从技术视角出发，侧重于领域模型的技术实现，完成软件开发和落地，包括：聚合根、实体、值对象、领域服务、应用服务和资源库等代码逻辑的设计和实现。
##### 领域和子域
    领域就是用来确定范围的，范围即边界，这也是 DDD 在设计中不断强调边界的原因。
    DDD 的领域就是这个边界内要解决的业务问题域。
    领域是用来限定业务边界和范围的，那么就会有大小之分，领域越大，业务范围就越大，反之则相反。
    领域可以进一步划分为子领域。我们把划分出来的多个子领域称为子域，每个子域对应一个更小的问题域或更小的业务范围。
##### 理解核心域、通用域和支撑域
    在领域不断划分的过程中，领域会细分为不同的子域，子域可以根据自身重要性和功能属性划分为三类子域，它们分别是：核心域、通用域和支撑域。
    决定产品和公司核心竞争力的子域是核心域，它是业务成功的主要因素和公司的核心竞争力。
    没有太多个性化的诉求，同时被多个子域使用的通用功能子域是通用域。
    还有一种功能子域是必需的，但既不包含决定产品和公司核心竞争力的功能，也不包含通用功能的子域，它就是支撑域。
##### 通用语言
    通过团队交流达成共识的，能够简单、清晰、准确描述业务涵义和规则的语言就是通用语言。
    通用语言包含术语和用例场景，并且能够直接反映在代码中。
##### 界限上下文
    为了避免同样的概念或语义在不同的上下文环境中产生歧义，DDD 在战略设计上提出了“限界上下文”这个概念，用来确定语义所在的领域边界。
    限界上下文拆解为两个词：限界和上下文。限界就是领域的边界，而上下文则是语义环境。通过领域的限界上下文，我们就可以在统一的领域边界内用统一的语言进行交流。
    商品在不同的阶段有不同的术语，在销售阶段是商品，而在运输阶段则变成了货物。同样的一个东西，由于业务领域的不同，赋予了这些术语不同的涵义和职责边界，这个边界就可能会成为未来微服务设计的边界。
##### 实体
    拥有唯一标识符，且标识符在历经各种状态变更后仍能保持一致。对这些对象而言，重要的不是其属性，而是其延续性和标识，对象的延续性和标识会跨越甚至超出软件的生命周期。我们把这样的对象称为实体。
    领域模型中的实体是多个属性、操作或行为的载体。在事件风暴中，我们可以根据命令、操作或者事件，找出产生这些行为的业务实体对象，进而按照一定的业务规则将依存度高和业务关联紧密的多个实体对象和值对象进行聚类，形成聚合。
    在代码模型中，实体的表现形式是实体类，这个类包含了实体的属性和方法，通过这些方法实现实体自身的业务逻辑。在 DDD 里，这些实体类通常采用充血模型，与这个实体相关的所有业务逻辑都在实体类的方法中实现，跨多个实体的领域逻辑则在领域服务中实现。
##### 实体的数据库形态
    与传统数据模型设计优先不同，DDD 是先构建领域模型，针对实际业务场景构建实体对象和行为，再将实体对象映射到数据持久化对象。
##### 值对象
    通过对象属性值来识别的对象，它将多个相关属性组合为一个概念整体。
    值对象描述了领域中的一件东西，这个东西是不可变的，它将不同的相关属性组合成了一个概念整体。当度量和描述改变时，可以用另外一个值对象予以替换。
##### 值对象的业务形态
    本质上，实体是看得到、摸得着的实实在在的业务对象，实体具有业务属性、业务行为和业务逻辑。而值对象只是若干个属性的集合，只有数据初始化操作和有限的不涉及修改数据的行为，基本不包含业务逻辑。值对象的属性集虽然在物理上独立出来了，但在逻辑上它仍然是实体属性的一部分，用于描述实体的特征。
##### 业务设计
    在领域建模时，我们可以将部分对象设计为值对象，保留对象的业务涵义，同时又减少了实体的数量；在数据建模时，我们可以将值对象嵌入实体，减少实体表的数量，简化数据库设计。
##### 实体和值对象的关系
    实体和值对象是微服务底层的最基础的对象，一起实现实体最基本的核心领域逻辑。
    DDD 提倡从领域模型设计出发，而不是先设计数据模型。前面讲过了，传统的数据模型设计通常是一个表对应一个实体，一个主表关联多个从表，当实体表太多的时候就很容易陷入无穷无尽的复杂的数据库设计，领域模型就很容易被数据模型绑架。可以说，值对象的诞生，在一定程度上，和实体是互补的。
##### 聚合
    实体一般对应业务对象，它具有业务属性和业务行为；而值对象主要是属性集合，对实体的状态和特征进行描述。实体和值对象行为表现出来的是个体的能力。
    领域模型内的实体和值对象就好比个体，而能让实体和值对象协同工作的组织就是聚合，它用来确保这些领域对象在实现共同的业务逻辑时，能保证数据一致性。
    领域层包含了多个聚合，共同实现核心业务逻辑。聚合内实体以充血模型实现个体业务能力，以及业务逻辑的高内聚。跨多个实体的业务逻辑通过领域服务来实现。跨多个聚合的业务逻辑通过应用服务来实现。
##### 聚合根
    聚合根主要目的是为了避免由于复杂数据模型缺少统一的业务规则控制，而导致聚合、实体之间数据不一致性的问题。
    聚合作为实体本身，拥有实体的属性和业务行为，实现自身的业务逻辑
    在聚合之间聚合根是对外的接口人，以聚合根ID关联的方式接收外部任务和请求，在上下文内实现聚合之间的业务协同。
##### 领域事件
    发生某种事情后，会触发进一步的操作
    领域事件驱动设计切断领域模型之间的强依赖关系，微服务之间的数据不必要求强一致性，而是基于事件的最终一致性
    